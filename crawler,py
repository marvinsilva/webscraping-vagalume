from bs4 import BeautifulSoup

class WebScrap:

    def request(self, artista):
        url = f'https://www.vagalume.com.br/{artista}/'
        req = Request(url)
        try:
            response = urlopen(req)
        except HTTPError as e:
            print('Código do erro: ', e.code)
            print(f'Não foi possível atender à solicitação para URL {url}')
            print(f'Favor verificar se o nome do artista ou banda está correto: {artista}')
            return False
        except URLError as e:
            print('Não conseguimos chegar a um servidor.')
            print('Motivo: ', e.reason)
            return False
        else:
            print("Solicitação requerida com sucesso!")
            print(f'Buscando por: {artista} ...')
            return True

    def search(self):
        url = f'https://www.vagalume.com.br/{artista}/'
        print(url)
        html_doc = urlopen(url).read()
        soup = BeautifulSoup(html_doc, "html.parser")
        top_musicas = []
        alfabet_musicas = []

        for top in soup.find(id="topMusicList").find_all("a", class_="nameMusic"):
            top_musicas.append(top.get_text())

        for top in soup.find(id="alfabetMusicList").find_all("a", class_="nameMusic"):
            alfabet_musicas.append(top.get_text())

        return top_musicas, alfabet_musicas
